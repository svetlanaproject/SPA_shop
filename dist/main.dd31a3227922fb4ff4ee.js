(()=>{"use strict";const e=document.querySelectorAll(".catalog__tab"),t=document.querySelectorAll(".catalog__content");document.querySelector(".catalog__tabs").addEventListener("click",(a=>{let c=a.target;if(c&&(c.classList.contains("catalog__tab")||c.parentNode.classList.contains("catalog__tab"))){let a=c.id;c.parentNode.classList.contains("catalog__tab")&&(a=c.parentNode.id,c=c.parentNode),e.forEach((e=>{e.classList.remove("catalog__tab_active")})),t.forEach((e=>{e.classList.remove("catalog__content_active")})),c.classList.add("catalog__tab_active"),e.forEach(((e,c)=>{if(e.id===a)return function(e=0){t[e].classList.add("catalog__content_active");const a=t[e].children;for(let e of a)e.querySelector(".catalog-item__content").classList.add("catalog-item__content_active"),e.querySelector(".catalog-item__list").classList.remove("catalog-item__list_active")}(c),!0}))}}));const a=document.querySelectorAll("[data-modalconsult]"),c=document.querySelector(".modal.consultation"),n=document.querySelector(".overlay"),o=document.querySelectorAll(".modal__close"),l=document.querySelector(".thanks");function r(){c.classList.add("modal_active"),n.classList.add("overlay_active")}a.forEach((e=>{e.addEventListener("click",r)})),document.querySelector("#consultation").addEventListener("click",(e=>{e.preventDefault();const t=e.target.parentNode;""!==t.elements.name.value&&""!==t.elements.phone.value||""!==t.elements.name.value&&""!==t.elements.email.value?(c.classList.remove("modal_active"),l.classList.add("modal_active"),t.reset()):alert("Заполните данные")}));const s=document.querySelectorAll(".button.button_mini"),i=document.querySelector(".modal.pay"),d=document.querySelector(".modal.pay .modal__descr ul");function m(e,t,a,c,n=!1){const o=document.querySelector(".modal__price"),l=document.querySelector(".header__cart_total");let r=parseInt(o.innerText.replace(/[^0-9]/gi,""));isNaN(r)&&(r=0),r+=a,o.innerText=`${(new Intl.NumberFormat).format(r)} руб`;let s=JSON.parse(localStorage.getItem("selected-items"));null===s&&(s=[]);const i=document.querySelector(`#${e}`);if(i){const t=i.querySelector(".item_price"),c=i.querySelector(".item_num");a+=parseInt(t.innerText.replace(/[^0-9]/gi,"")),t.innerText=`${(new Intl.NumberFormat).format(a)} руб`;const n=s.find((({id:t})=>t===e));n&&(n.price=a,n.num+=1),c.innerText=n.num}else{const n=document.createElement("li");n.id=e;const o=document.createElement("span");o.classList="item_name",o.innerText=t;const l=document.createElement("span");l.classList="item_num",l.innerText=c;const r=document.createElement("span");r.classList="item_price",r.innerText=`${(new Intl.NumberFormat).format(a)} руб`;const i=document.createElement("span");i.classList="item_remove",i.innerHTML="&times;",i.addEventListener("click",(e=>{const t=e.target.parentNode.id;e.target.parentNode.remove();let a=JSON.parse(localStorage.getItem("selected-items"));if(null!==a&&a.length){const e=a.map((({id:e})=>e)).indexOf(t);if(-1!==e){const t=document.querySelector(".modal__price");let c=parseInt(t.innerText.replace(/[^0-9]/gi,""));c-=a[e].price,t.innerText=`${(new Intl.NumberFormat).format(c)} руб`,a.splice(e,1),localStorage.setItem("selected-items",JSON.stringify(a))}}})),n.append(o,i,r,l),d.append(n);const m={name:t,price:a,num:c,id:e};s.push(m)}if(!n){localStorage.setItem("selected-items",JSON.stringify(s));const e=s.reduce(((e,t)=>e+t.num),0);l.innerText=e}}function u(e){e.target.parentNode.classList.remove("modal_active"),n.classList.remove("overlay_active")}s.forEach((e=>{e.addEventListener("click",(e=>{i.classList.add("modal_active"),n.classList.add("overlay_active");const t=e.target.dataset.id.replace(/\s|\./g,"_").toLowerCase();let a=parseInt(e.target.previousElementSibling.innerText.replace(/[^0-9]/gi,""));m(t,e.target.dataset.itemname,a,1)}))})),window.addEventListener("load",(e=>{let t=JSON.parse(localStorage.getItem("selected-items"));if(null!==t&&t.length){const e=document.querySelector(".header__cart_total"),a=t.reduce(((e,t)=>e+t.num),0);e.innerText=a,t.forEach((({id:e,name:t,price:a,num:c})=>m(e,t,a,c,!0)))}})),o.forEach((e=>{e.addEventListener("click",(e=>{u(e)}))})),document.addEventListener("keydown",(e=>{"Escape"===e.code&&u(e)})),window.addEventListener("scroll",(function e(){window.pageYOffset+document.documentElement.clientHeight>=document.documentElement.scrollHeight-1&&(setTimeout(r,3e3),window.removeEventListener("scroll",e))})),document.querySelectorAll(".catalog-item__link").forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault(),e.target.parentNode.classList.contains("catalog-item__content_active")&&(e.target.parentNode.classList.remove("catalog-item__content_active"),document.querySelector(`#${e.target.dataset.target}`).classList.add("catalog-item__list_active"))}))})),document.querySelectorAll(".catalog-item__back").forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault(),e.target.parentNode.classList.remove("catalog-item__list_active"),e.target.parentNode.parentNode.querySelector(".catalog-item__content").classList.add("catalog-item__content_active")}))})),document.querySelector("#pay").addEventListener("click",(e=>{e.preventDefault();const t=e.target.parentNode.parentNode;console.log(e.target.parentNode),""!==t.elements.name.value&&""!==t.elements.phone.value||""!==t.elements.name.value&&""!==t.elements.email.value?(i.classList.remove("modal_active"),l.classList.add("modal_active"),t.reset(),localStorage.removeItem("selected-items"),d.replaceChildren()):alert("Заполните данные")})),document.querySelector(".header__cart").addEventListener("click",(e=>{e.preventDefault(),i.classList.add("modal_active"),n.classList.add("overlay_active")}))})();
//# sourceMappingURL=main.dd31a3227922fb4ff4ee.js.map